---
import { images } from '../data/global';
import { useTranslations, getLangFromUrl } from '../i18n/index';

export interface Props {
  titleKey: string;
  subtitleKey?: string;
  descriptionKey: string;
  imageUrl: string;
  imageAltKey: string;
  linkUrl?: string;
  linkTextKey?: string;
  linkIcon?: string;
}

const { 
  titleKey, 
  subtitleKey,
  descriptionKey, 
  imageUrl, 
  imageAltKey, 
  linkUrl,
  linkTextKey,
  linkIcon = "icon-external-link"
} = Astro.props;

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

// Resolve translation keys
const title = t(titleKey);
const subtitle = subtitleKey ? t(subtitleKey) : undefined;
const description = t(descriptionKey);
const imageAlt = t(imageAltKey);
const linkText = linkTextKey ? t(linkTextKey) : t('projectCardLinkText');

// Construct image path once for performance
const imagePath = `${images}/${imageUrl}`;
---

<article class="book-item">
  <a data-fslightbox="books" href={imagePath} class="hover-shift-sm">
    <img src={imagePath} alt={imageAlt} class="book-image" loading="lazy">
  </a>

  <div class="book-info">
    <div>
      <h5 class="mb-0 book-title">{title}</h5>
      {subtitle && <p class="mb-0"><em>{subtitle}</em></p>}
    </div>
    <p class="book-description">{description}</p>
    
    {linkUrl && (
      <a href={linkUrl} target="_blank" 
         class={`icon-after ${linkIcon} icon-space-sm`}
         rel="noopener noreferrer">
        {linkText}
      </a>
    )}
  </div>
</article>