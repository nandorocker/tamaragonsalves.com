---
import { images } from '../data/global';
import { useTranslations } from '../i18n/index';

export interface Props {
  title: string;
  description: string;
  videoUrl: string;
  thumbnailUrl: string;
  date: string;
  linkText?: string;
}

const { 
  title,
  description,
  videoUrl,
  thumbnailUrl,
  date,
  linkText
} = Astro.props;

const t = useTranslations((Astro.currentLocale as 'en') || 'en');
const defaultLinkText = linkText || t('videoPublicationCardLinkText');

// Format date once at build time for better performance
const formattedDate = new Date(date).toLocaleDateString('en-US', { 
  year: 'numeric', 
  month: 'long', 
  day: 'numeric' 
});

// Construct image path once
const imagePath = `${images}/${thumbnailUrl}`;
---

<div class="video-card">
  <a href={videoUrl} target="_blank" aria-label={`Watch video: ${title}`} rel="noopener noreferrer">
    <div class="video-thumbnail-container">
      <img src={imagePath} alt={`Video thumbnail for ${title}`} loading="lazy">
    </div>
  </a>
  <time datetime={date} class="video-date">{formattedDate}</time>
  <h5 class="video-title">{title}</h5>
  <p class="video-description">{description}</p>
  <a href={videoUrl} target="_blank" 
     class="video-link icon-after icon-external-link icon-space-sm"
     rel="noopener noreferrer">
    {defaultLinkText}
  </a>
</div>