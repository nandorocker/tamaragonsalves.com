---
import BaseLayout from '../../layouts/BaseLayout.astro';
import AboutGalleryImage from '../../components/AboutGalleryImage.astro';
import BookCarouselCard from '../../components/BookCarouselCard.astro';
import VideoPublicationCard from '../../components/VideoPublicationCard.astro';
import Button from '../../components/Button.astro';
import { images } from '../../data/global';
import { loadAllTranslations, getTranslationSync, getStaticPaths } from '../../utils/i18n';
import type { Language } from '../../utils/i18n';
import galleryData from '../../data/gallery.json';
import booksData from '../../data/books.json';
import videosData from '../../data/videos.json';

export { getStaticPaths };

const { lang } = Astro.params;
const currentLang = lang as Language;

// Load all translations (global + home page) for dynamic content
const allTranslations = await loadAllTranslations(currentLang, 'home');

// Load book translations specifically
const allContentTranslations = await loadAllTranslations(currentLang, 'books');
const bookTranslations = allContentTranslations.books || {};

// Helper function to get translation with fallback
const t = (key: string) => getTranslationSync(allTranslations, key);
---

<BaseLayout title={t('pageTitle')} pageTheme="yellow">
	<section id="home"
	    class="hero bg-gradient-yellow dark:bg-gradient-to-br dark:from-gray-800 dark:to-gray-900 flex items-center w-full h-80vh min-h-[50rem] bg-mustard-50]">
	    <div class="w-full contain-wide section-margins-medium text-center">
	        <h3 class="text-indigo-900 dark:text-indigo-300">{getTranslationSync(allTranslations, 'heroSection.subtitle')}</h3>
	        <h1 class="text-indigo-900 dark:text-indigo-300" set:html={getTranslationSync(allTranslations, 'heroSection.name').replace(' ', '<br> ')}></h1>
	        <p class=" bigger max-sm:hyphens-auto md:w-4/6 mx-auto">{getTranslationSync(allTranslations, 'heroSection.description')}</p>
	    </div>
	</section>

	<section id="about-me" class="about-me w-full contain-margins-y bg-white dark:bg-gray-800">
	    <div
	        class="contain-narrow md:contain-medium section-margins-narrow md:section-margins-medium grid sm:grid-cols-2 lg:grid-cols-2 xl:grid-cols-[2fr_1fr] gap-8 lg:gap-12 items-start">
            <div class="w-full mx-auto sm:-mt-40 max-sm:row-start-2 grid md:grid-cols-2 gap-4">
                {galleryData.map((image) => (
                    <AboutGalleryImage 
                        src={image.src}
                        altKey={image.altKey}
                        fslightboxGroup={image.fslightboxGroup}
                        gridClass={image.gridClass}
                    />
                ))}
            </div>
	        <div class="ml-auto lg:w-5/6 max-sm:row-start-1">
	            <h2>{t('aboutMeHeading')}</h2>
	            <p>{t('aboutMeDescription')}</p>
	            
	            <div class="flex flex-col gap-4 mt-6">
	                <Button href={`/${currentLang}/background`} variant="secondary" icon="icon-file-pdf" class="mb-0">
	                    {t('publicationsCvLinkText')}
	                </Button>
	                <Button href={t('publicationsOrcidUrl')} variant="secondary" target="_blank" iconSrc="/images/orcid_id.svg">
	                    {t('publicationsOrcidLinkText')}
	                </Button>
	            </div>
	        </div>
	    </div>
	</section>

	<section id="publications-preview" class="contain-margins-y bg-soap-50 dark:bg-gray-700">
		<div class="contain-wide section-margins-medium">
			<h1 class="mb-8">{t('publicationsHeading')}</h1>
			
			<div class="sm:max-w-[560px] md:max-w-screen-sm lg:max-w-screen-lg mx-auto">
				<p class="mb-6 dark:text-gray-300">
					Over the past 20 years, I have developed interdisciplinary research, resulting in 2 published books, 40 book chapters, 11 journal articles, 10 research reports, and 36 opinion pieces on children's rights, women's human rights, and consumer rights.
				</p>

				<h2 class="mb-6">{t('publicationsBooksSubheading')}</h2>
				
				<!-- Book Carousel -->
				<div class="book-carousel relative">
					<div class="carousel-outer-container py-4 relative">
						<div class="carousel-container overflow-hidden relative" style="clip-path: inset(0);">
							<div class="carousel-track flex transition-transform duration-500 ease-in-out">
								{booksData.map((book, index) => (
									<div class="carousel-slide w-full lg:w-1/2 flex-shrink-0">
										<div class={`${index < booksData.length - 1 ? 'pr-4 lg:pr-6' : ''}`}>
											<BookCarouselCard 
												book={book}
												bookTranslations={bookTranslations}
												lang={currentLang}
											/>
										</div>
									</div>
								))}
							</div>
						</div>
					</div>

					<!-- Previous Button -->
					<button 
						id="prev-book" 
						class="carousel-btn absolute left-0 md:-left-1 lg:-left-2 top-16 md:top-20 -translate-x-4 md:-translate-x-12 z-[5] p-3 rounded-full bg-pink-700 text-white hover:bg-pink-900 dark:bg-pink-300 dark:text-gray-900 dark:hover:bg-pink-100 transition-colors disabled:opacity-20 disabled:cursor-not-allowed shadow-lg"
						aria-label="Previous books"
					>
						<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
						</svg>
					</button>
					
					<!-- Next Button -->
					<button 
						id="next-book" 
						class="carousel-btn absolute right-0 md:-right-1 lg:-right-2 top-16 md:top-20 translate-x-4 md:translate-x-12 z-[5] p-3 rounded-full bg-pink-700 text-white hover:bg-pink-900 dark:bg-pink-300 dark:text-gray-900 dark:hover:bg-pink-100 transition-colors disabled:opacity-20 disabled:cursor-not-allowed shadow-lg"
						aria-label="Next books"
					>
						<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
						</svg>
					</button>
				</div>
				
				<div class="text-center mt-12">
					<Button href={`/${currentLang}/publications`} variant="secondary" size="lg">{t('seeAllPublications')}</Button>
				</div>
			</div>
		</div>
	</section>

	<section id="speaking-preview" class="contain-margins-y bg-white dark:bg-gray-800">
		<div class="contain-medium section-margins-medium">
			<h1 class="mb-6 dark:text-pink-300"><a href={`/${currentLang}/speaking`} class="hover:text-sky-700 dark:hover:text-sky-300 transition-colors">{t('speakingHeading')}</a></h1>
			
			<div class="sm:max-w-[560px] md:max-w-screen-sm lg:max-w-screen-lg mx-auto">
				<p class="mb-8 dark:text-gray-300">
					{t('speakingIntroStart')}<a href={`/${currentLang}/#contact-me`} class="font-semibold text-sky-700 dark:text-sky-300 hover:text-sky-900 dark:hover:text-sky-100">{t('speakingCTALink')}</a>{t('speakingIntroEnd')}
				</p>

				<div class="flex flex-col lg:flex-row lg:justify-between items-start lg:items-end gap-2 lg:gap-0 mb-6">
					<h2 class="mb-0 dark:text-pink-300">{t('speakingTalksSubheading')}</h2>
					<a href={`/${currentLang}/speaking`} class="text-base font-semibold text-sky-700 dark:text-sky-300 hover:text-sky-900 dark:hover:text-sky-100 icon-after icon-arrow-right icon-space-sm whitespace-nowrap">
						{t('seeAllTalks')}
					</a>
				</div>
			</div>
		</div>

		<div class="w-full">
			<div class="video-grid-container 2xl:justify-center">
				<div class="video-grid">
					{videosData.slice(0, 5).map(video => (
						<VideoPublicationCard 
							id={video.id}
							videoUrl={video.videoUrl}
							thumbnailUrl={video.thumbnailUrl}
							date={video.date}
							lang={currentLang}
						/>
					))}
				</div>
			</div>
		</div>
	</section>

	<section id="what-i-offer" class="contain-margins-y bg-violet-50 dark:bg-gray-700">
		<div class="contain-medium section-margins-medium">
			<h1 class="mb-8 dark:text-pink-300">{t('servicesHeading')}</h1>
			
			<div class="sm:max-w-[560px] md:max-w-screen-sm lg:max-w-screen-lg mx-auto">
				<p class="mb-8 dark:text-gray-300">
					{t('servicesIntro')}
				</p>

				<div class="sm:grid sm:grid-cols-2 gap-x-10 lg:gap-x-16 mb-12">
					<div>
						<div class="services-item pb-6">
							<h3 class="dark:text-pink-300">{t('coursesTitle')}</h3>
							<p class="dark:text-gray-300">{t('coursesSummary')}</p>
						</div>
						<div class="services-item pb-6">
							<h3 class="dark:text-pink-300">{t('consultancyTitle')}</h3>
							<p class="dark:text-gray-300">{t('consultancySummary')}</p>
						</div>
						<div class="services-item pb-6">
							<h3 class="dark:text-pink-300">{t('lawyeringTitle')}</h3>
							<p class="dark:text-gray-300">{t('lawyeringSummary')}</p>
						</div>
					</div>

					<div>
						<div class="services-item pb-6">
							<h3 class="dark:text-pink-300">{t('mentorshipTitle')}</h3>
							<p class="dark:text-gray-300">{t('mentorshipSummary')}</p>
						</div>
						<div class="services-item pb-6">
							<h3 class="dark:text-pink-300">{t('advocacyTitle')}</h3>
							<p class="dark:text-gray-300">{t('advocacySummary')}</p>
						</div>
					</div>
				</div>
				
				<div class="text-center mt-0">
					<Button href={`/${currentLang}/services`} variant="secondary" size="lg">{t('seeAllServices')}</Button>
				</div>
			</div>
		</div>
	</section>

	<section id="contact-me" class="contain-margins-y bg-white dark:bg-gray-800">
		<div class="contain-medium section-margins-medium">
			<h1 class="dark:text-pink-300">{t('contactHeading')}</h1>
			<div class="sm:max-w-[560px] md:max-w-screen-sm lg:max-w-screen-md mx-auto mb-12">
			<p class="dark:text-gray-300">{t('contactDescription')}</p>

			<p><Button id="email-link" href="#" size="lg" class="max-sm:block md:px-12 md:py-4 md:text-lg md:rounded-xl icon-before icon-comment-smile icon-space-sm">{t('contactEmailButtonText')}</Button>
			</p>				<h4 class="max-sm:text-center dark:text-pink-300">{t('contactSocialMediaHeading')}</h4>
				<ul class="flex flex-row max-sm:justify-center items-start gap-8 max-sm:mt-8">
					<li><a href="https://www.instagram.com/tamaramoroso" target="_blank" rel="noopener noreferrer"
							title="Threads"><img src={`${images}/social-instagram.svg`} class="w-12 hover-shift-sm dark:invert"
								alt="Instagram"></a>
					</li>
					<li><a href="https://www.linkedin.com/in/tamara-amoroso-gonsalves-941527229/" target="_blank"
							rel="noopener noreferrer" title="LinkedIn"><img src={`${images}/social-linkedin.svg`}
								class="w-12 hover-shift-sm dark:invert" alt="LinkedIn"></a>
					</li>
				</ul>
			</div>
		</div>
	</section>
</BaseLayout>
